{
 "add_total_row": 0,
 "add_translate_data": 0,
 "columns": [],
 "creation": "2025-05-21 12:22:29.595196",
 "disabled": 0,
 "docstatus": 0,
 "doctype": "Report",
 "filters": [],
 "idx": 12,
 "is_standard": "Yes",
 "letter_head": "Nexapp",
 "letterhead": null,
 "modified": "2025-06-27 18:54:09.682592",
 "modified_by": "Administrator",
 "module": "Nexapp",
 "name": "Billing Data",
 "owner": "Administrator",
 "prepared_report": 0,
 "query": "SELECT\n    so.name AS \"Sales Order No:Link/Sales Order:150\",\n    so.status AS \"SO Status:Data:100\",\n\n    so.customer_name AS \"Customer:Data:150\",\n    so.transaction_date AS \"SO Date:Date:100\",\n    so.po_no AS \"PO No:Data:100\",\n    so.po_date AS \"PO Date:Date:100\",\n    so.custom_customer_purchase_amount AS \"PO Amount:Currency:100\",\n    so.project AS \"Project:Link/Project:120\",\n    so.rounded_total AS \"SO Amount:Currency:100\",\n\n    si.name AS \"Invoice No:Link/Sales Invoice:150\",\n    si.posting_date AS \"Invoice Date:Date:100\",\n    si.custom_start_date AS \"Start Date:Date:100\",\n    si.custom_end_date AS \"End Date:Date:100\",\n    si.status AS \"Invoice Status:Data:100\",\n    si.rounded_total AS \"Invoice Amount:Currency:100\",\n\n    inv.total_invoiced AS \"Total Invoiced:Currency:100\",\n    (so.rounded_total - IFNULL(inv.total_invoiced, 0)) AS \"Balance Billing:Currency:100\",\n\n    sii.custom_circuit_id AS \"Circuit ID:Data:120\",\n    sii.custom_site_info AS \"Site Name:Data:150\",\n    sii.custom_solution AS \"Solution:Data:150\",\n    sii.item_name AS \"Item Name:Data:150\",\n    sii.amount AS \"Item Amount:Currency:100\"\n\nFROM `tabSales Order` so\n\n-- \u2705 Join to Sales Invoice (only valid ones)\nLEFT JOIN `tabSales Invoice` si \n    ON si.custom_sales_order = so.name\n   AND si.status NOT IN ('Cancelled', 'Draft')\n\n-- \u2705 Join to Sales Invoice Item\nLEFT JOIN `tabSales Invoice Item` sii\n    ON sii.parent = si.name\n\n-- \u2705 Subquery: total invoiced amount per SO\nLEFT JOIN (\n    SELECT\n        si.custom_sales_order AS sales_order,\n        SUM(si.rounded_total) AS total_invoiced\n    FROM `tabSales Invoice` si\n    WHERE si.status NOT IN ('Cancelled', 'Draft')\n    GROUP BY si.custom_sales_order\n) inv ON inv.sales_order = so.name\n\n-- \u2705 Filter out unwanted Sales Orders\nWHERE so.status NOT IN ('Cancelled', 'Draft')\n\nORDER BY so.transaction_date DESC;\n",
 "ref_doctype": "Sales Order",
 "report_name": "Billing Data",
 "report_type": "Query Report",
 "roles": [
  {
   "role": "System Manager"
  },
  {
   "role": "Support Manager"
  },
  {
   "role": "Account Receivable User"
  },
  {
   "role": "Accounts  & Finance Manager"
  },
  {
   "role": "Accounts Manager"
  },
  {
   "role": "accounts receivable"
  }
 ],
 "timeout": 0
}